---
page_title: "cm_disaster_recovery_configuration Resource - terraform-provider-cm"
subcategory: ""
description: |-
  Creates, updates and destroys disaster recovery configurations. For more information: ControlMonkey Documentation https://docs.controlmonkey.io/main-concepts/disaster-recovery
---

# cm_disaster_recovery_configuration (Resource)

Creates, updates and destroys disaster recovery configurations. For more information: [ControlMonkey Documentation](https://docs.controlmonkey.io/main-concepts/disaster-recovery)

## Learn More

- [ControlMonkey Total Cloud Resilience](https://controlmonkey.io/solution/cloud-resilience/)
- [Cloud Disaster Recovery with Terraform: Strategies That Work](https://controlmonkey.io/blog/cloud-disaster-recovery/)
- [AWS Networking DR Plan with Terraform](https://controlmonkey.io/blog/aws_networking_architecture_dr_plan/)

## Example Usage
### Default ControlMonkey Behavior for Backing Up Resources (Including Managed Resources).
```terraform
resource "cm_disaster_recovery_configuration" "dr_config" {
  scope            = "aws"
  cloud_account_id = "123465789"

  backup_strategy = {
    include_managed_resources = true
    mode                      = "default"

    vcs_info = {
      provider_id = "vcsp-123"
      repo_name   = "terraform-backup"
      branch      = "main"
    }
  }
}
```

### Custom Backup Strategy: Matching awsQuery Resources Pushed to a Specific path.
```terraform
resource "cm_disaster_recovery_configuration" "dr_config" {
  scope            = "aws"
  cloud_account_id = "123465789"

  backup_strategy = {
    include_managed_resources = true
    mode                      = "manual"

    vcs_info = {
      provider_id = "vcsp-123"
      repo_name   = "terraform-backup"
      branch      = "main"
    }

    groups_json = jsonencode(
      [
        {
          "vcsInfo": {
            "path": "ec2/instances/us-east-1"
          }

          "awsQuery": {
            "region": "us-east-1",
            "services": ["AWS::EC2"],
            "resourceTypes": ["AWS::EC2::Instance"]

            "tags": [
              {
                "key": "Env",
                "value": "Prod"
              }
            ]
          }
        },
      ]
    )
  }
}
```

### Disaster Recovery Configuration with Group-Specific Destinations (Supports All JSON Formats)
```terraform
resource "cm_disaster_recovery_configuration" "autoManagedStackConfiguration" {
  scope            = "aws"
  cloud_account_id = "123456789"

  backup_strategy = {
    include_managed_resources = true
    mode                      = "manual"

    vcs_info = {
      provider_id = "vcsp-123"
      repo_name   = "terraform-backup"
      branch      = "main"
    }

    groups_json = jsonencode(
      [
        {
          "vcsInfo": {
            "path": "s3/us-east-1"
          }

          "awsQuery": {
            "region": "us-east-1",
            "services": ["AWS::S3"],
            "resourceTypes": ["AWS::S3::Bucket"]
          }
        },
        {
          "vcsInfo": {
            "path": "ecs/us-east-1"
          }

          "awsQuery": {
            "region": "us-east-1",
            "services": ["AWS::ECS"]
          }
        },
        {
          "vcsInfo": {
            "path": "ec2/us-east-1"
          }

          "awsQuery": {
            "region": "us-east-1",
            "services": ["AWS::EC2"]
          }
        }
      ]
    )
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `backup_strategy` (Attributes) The configuration specifying where the backup will be stored and how to break down your resources. (see [below for nested schema](#nestedatt--backup_strategy))
- `cloud_account_id` (String) The identifier of the cloud account, such as an AWS Account ID for AWS or a Subscription ID for Azure.
- `scope` (String) Specifies the cloud provider type, such as `aws`.

### Read-Only

- `id` (String) The ID of the disaster recovery configuration.

<a id="nestedatt--backup_strategy"></a>
### Nested Schema for `backup_strategy`

Required:

- `include_managed_resources` (Boolean) Indicates whether managed resources should be included in the backup.
- `mode` (String) Specify the backup strategy mode whether you want the default ControlMonkey behaviour or your own custom strategy. Allowed values: [default, manual].
- `vcs_info` (Attributes) Configuration details for the version control system where the disaster recovery snapshot will be stored. (see [below for nested schema](#nestedatt--backup_strategy--vcs_info))

Optional:

- `groups_json` (String) JSON format of your custom strategy. Describe how to group the resources we backup into your VCS. This field is required only when `mode` is set to `manual`. This field is not allowed when `mode` is set to `default`.
For more information: [ControlMonkey Documentation](https://docs.controlmonkey.io/main-concepts/disaster-recovery/infrastructure-daily-backup#how-to-configure)

<a id="nestedatt--backup_strategy--vcs_info"></a>
### Nested Schema for `backup_strategy.vcs_info`

Required:

- `branch` (String) The target branch the disaster recovery snapshot will be pushed to.
- `provider_id` (String) The ControlMonkey unique ID of the connected version control system.
- `repo_name` (String) The name of the version control repository.

## Import

`cm_disaster_recovery_configuration` can be imported using the ID of the Disaster Recovery Configuration, e.g.

```shell
terraform import cm_disaster_recovery_configuration.dr_config drc-123
```